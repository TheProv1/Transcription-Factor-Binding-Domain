# Transcription-Factor-Binding-Domain

## Project Overview

This project is a collection of Python scripts designed to perform a multi-stage analysis on a hierarchically organized dataset of transcription factor protein sequences. The pipeline automates the process of parsing raw data, extracting functionally relevant protein domains, analyzing their biophysical properties, and visualizing their sequence composition.

## Dataset Description/Information

This dataset is hierarchically organised as `superclass-class-family-subfamily`.

For example, the file `1/1.1/1.1.1/1.1.1.1.txt` will be refered to as belonging to superclass 1, class 1, family 1, and sub-family 1.

Each subfamily contains one or more `.txt` files, and within each `.txt` file there can exist multiple transcription factors. Each transcription factor is a long chain of amino acids.

Note: Here `ANCHOR` refers to the last column in the text file - also known as the `DBD Flag`

*   **DBD Region** - Refers to the region where the protein binds to the DNA, which in turn activates/enables gene expression. In this dataset, this is identified by the `ANCHOR` column being `"Yes"`.
*   **Non-DBD Region** - The remaining region of the protein that does not bind to DNA.

It is hypothesized that the DBD region is structurally ordered, while the Non-DBD region is intrinsically disordered.

In order to separate the transcription factors from each other within a single `.txt` file, we keep checking the **POS_IU** Header (the 5th column). When the residue number in the current line is less than the previous line, it signifies a reset, and we consider it the end of one transcription factor and the beginning of a new one. This process continues till the end of the file.

---
## Script Descriptions

### `DBD-Splitting-Code.py`

*   **Purpose:** This is the primary data cleaning and preprocessing script. Its goal is to parse the entire raw dataset and extract only the functionally relevant ANCHOR/DBD regions into a new, clean, and organized directory structure.

*   **Input:** The raw `NR_HI_IU` directory containing the original data.

*   **Process:**
    1.  Recursively scans every `.txt` file in the `NR_HI_IU` directory.
    2.  Identifies the boundaries of individual transcription factors by detecting resets in the `POS_IU` column.
    3.  For each transcription factor, it filters for rows where the `ANCHOR` column (the 8th column) is exactly `"Yes"`.
    4.  It selects and reformats only the last four columns: `POS_IU`, `RES_IU`, `IU`, and `ANCHOR`.

*   **Output:** Creates a new directory (e.g., `DBD_Split` or `ANCHOR_regions_by_family`) containing the extracted ANCHOR region files. These new files are sorted into subdirectories named after the family they belong to (e.g., `1.1.1`, `1.1.2`, etc.).

---
### `DBD-Disorder-Code.py`

*   **Purpose:** To analyze the extracted ANCHOR/DBD regions and filter them based on their level of intrinsic disorder.

*   **Input:** The `DBD_Split` directory generated by `DBD-Splitting-Code.py`.

*   **Process:**
    1.  Prompts the user to enter a disorder percentage threshold (e.g., `80`).
    2.  Iterates through every ANCHOR region file in the `DBD_Split` directory.
    3.  For each file, it calculates the disorder percentage using the formula:
        `Disorder % = (Number of amino acids with IUPred Score > 0.5 / Total number of amino acids) * 100`
    4.  It compares this calculated percentage to the user's input threshold.

*   **Output:** Creates a single `.csv` file named dynamically (e.g., `DBD_disorder_above_80.csv`). This file contains two columns: `filename` and `disorder_percentage`, listing only the files that met or exceeded the specified disorder threshold.

---
### `complete-window-code.py`

*   **Purpose:** To perform a comprehensive compositional analysis on the *full* original protein sequences by counting the frequency of all possible amino acid patterns (k-mers).

*   **Input:** The original, raw `NR_HI_IU` directory.

*   **Process:**
    1.  Initiates a loop that iterates through window sizes from 3 to 11.
    2.  For each window size, it recursively traverses the entire `NR_HI_IU` directory.
    3.  It uses a sliding window of the current size (e.g., 3 for triplets) to count the occurrences of every unique amino acid pattern within each individual transcription factor.

*   **Output:** Creates a large `output` directory. This directory is structured by window size (e.g., `output/3/`, `output/4/`, etc.), which in turn are organized by filename. Each final `.txt` file contains a detailed list of every pattern found and its total count for a specific transcription factor.

---
### `Amino-Acid-Distribution.py`

*   **Purpose:** To visualize the amino acid composition of the most statistically significant patterns discovered by the window analysis.

*   **Input:** The `output/3/` directory generated by `complete-window-code.py`.

*   **Process:**
    1.  Reads each analysis file from the `output/3/` directory.
    2.  Identifies all triplets (3-amino-acid chains) that have an occurrence count of 3 or more.
    3.  It then calculates a **weighted distribution** of the individual amino acids that make up *only these frequent triplets*. For example, if the triplet `AAA` occurred 6 times, it contributes `6 * 3 = 18` counts of the amino acid 'A' to the total.
    4.  Generates a bar chart (histogram) visualizing this amino acid distribution, with the total count displayed on top of each bar.

*   **Output:** Creates a directory named `frequent_triplet_histograms` containing a `.png` histogram image for each transcription factor that had frequent triplets.